<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>THDX â€¢ LZ Receiver Lite (v1.4.4 Proofless)</title>
<style>
body{font-family:system-ui,Arial;background:#0b1220;color:#fff;margin:0;min-height:100vh;display:grid;place-items:center}
.card{width:min(600px,90vw);background:#121a2a;border:1px solid #22304a;border-radius:12px;padding:24px;box-shadow:0 8px 20px rgba(0,0,0,.5)}
h1{text-align:center;color:#7c5cff;margin:0 0 12px}
button{width:100%;padding:12px;border:0;border-radius:10px;margin-top:8px;font-weight:700;font-size:15px;cursor:pointer}
.primary{background:linear-gradient(90deg,#6ee7ff,#7c5cff);color:#000}
.ok{background:linear-gradient(90deg,#22c55e,#16a34a);color:#fff}
input,textarea{width:100%;padding:10px;margin-top:8px;border-radius:10px;border:1px solid #22304a;background:#0f1625;color:#fff;font-size:14px}
pre{background:#0f1625;border:1px solid #22304a;border-radius:10px;padding:10px;margin-top:14px;white-space:pre-wrap;overflow:auto;max-height:240px;font-size:13px}
small{color:#9fb0d9}
</style>
</head>
<body>
<div class="card">
  <h1>ğŸŒ THDX â€¢ LZ Receiver Lite</h1>
  <button id="connect" class="primary">ğŸ”Œ Connect Wallet</button>
  <input id="txHash" placeholder="TX hash Sepolia (opsional)" />
  <button id="fetch" class="ok">ğŸ“¥ Ambil Payload</button>
  <button id="auto" class="ok">âš¡ Auto Payload (10 USDC)</button>
  <pre id="log">log siap...</pre>
</div>
<script>
(async()=>{
  function log(m){const el=document.getElementById("log");el.textContent+=(el.textContent?"\n":"")+m;el.scrollTop=el.scrollHeight;console.log(m);}
  let provider,signer,me;
  const CHAINS={11155111:{name:"Sepolia",rpc:"https://rpc.sepolia.org"}};
  if(window.ethereum){
    const ethersScript=document.createElement("script");
    ethersScript.src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js";
    ethersScript.onload=()=>log("âœ… ethers.js loaded");
    document.head.appendChild(ethersScript);
  }
  document.getElementById("connect").onclick=async()=>{
    try{
      provider=new ethers.providers.Web3Provider(window.ethereum,"any");
      await provider.send("eth_requestAccounts",[]);
      signer=provider.getSigner();
      me=await signer.getAddress();
      const net=await provider.getNetwork();
      log(`âœ… Connected: ${me}\nChain: ${net.chainId}`);
    }catch(e){log("âŒ Connect error: "+(e.message||e));}
  };
  async function fetchPayload(){
    const txh=document.getElementById("txHash").value.trim();
    if(!txh){return log("âš ï¸ Isi TX hash atau gunakan Auto Payload");}
    try{
      const sepolia=new ethers.providers.JsonRpcProvider(CHAINS[11155111].rpc);
      const rcpt=await sepolia.getTransactionReceipt(txh);
      if(!rcpt)return log("âŒ Receipt belum tersedia.");
      let candidate=null;
      for(const lg of rcpt.logs){if(lg.data&&lg.data.length>=130){if(!candidate||lg.data.length>candidate.length)candidate=lg.data;}}
      if(!candidate)return log("âŒ Tidak ada payload ditemukan.");
      const clean=candidate.slice(2);const payload="0x"+clean.slice(0,128);
      const addr="0x"+clean.slice(24,64);
      const amt=ethers.BigNumber.from("0x"+clean.slice(64,128));
      log(`âœ… Payload ditemukan: ${payload}\nğŸ‘¤ to=${addr}\nğŸ’° amount=${ethers.utils.formatUnits(amt,6)} USDC`);
    }catch(e){log("âŒ Error: "+(e.message||e));}
  }
  async function autoPayload(){
    if(!window.ethers)return log("âš ï¸ ethers belum siap.");
    const addr="0x"+me.slice(2).padStart(64,"0");
    const amt=ethers.utils.hexZeroPad(ethers.BigNumber.from("10000000").toHexString(),32);
    const payload=addr+amt.slice(2);
    log(`âš¡ Auto Payload: ${payload}\nğŸ‘¤ to=${me}\nğŸ’° 10 USDC`);
  }
  document.getElementById("fetch").onclick=fetchPayload;
  document.getElementById("auto").onclick=autoPayload;
})();
</script>
</body>
</html>
